  select 
     u.user_id,
     u.first_name,
     u.last_name,
     u.email,
     u.phone_number,
     a.zipcode,
     a.state,
     max(o.created_at_utc) as last_order_date_utc,
     count(o.order_id) as order_count
  from users as u
  join addresses as a on a.address_id = u.address_id
  left join orders as o on o.user_id = u.user_id

  group by u.user_id, u.first_name, u.last_name, u.email, u.phone_number, a.zipcode, a.state
